```{julia}
using NetCDFTools
using NCDatasets
using Ipaper
using GLMakie
using MakieLayers
# using JLD2
includet("FY-4B.jl")
lon, lat = load_FY_latlon("4km")

f = "data/FY4B-_AGRI--_N_DISK_1050E_L1-_FDI-_MULT_NOM_20240502030000_20240502031459_4000M_V0001.HDF"
nc = nc_open(f)
```

```{julia}
# nc.group["Data"]["NOMChannel01"]
@time val = read_band(nc, "Channel12");
fig = Figure(; size=(1000, 800))
imagesc!(fig, 1:n, 1:n, val[:, end:-1:1]; colors=:grays, title="")
fig
# Int64.(nom.attrib["valid_range"]): 0, 4095
```

```{julia}
_dims = [
  NcDim("x", 1:size(lon, 1)),
  NcDim("y", 1:size(lon, 2))]
nc_write!("data/FY4B_DISK_lonlat_4km.nc", (; lon, lat), _dims)
```

## 知道经纬度之后，如何转为WGS84
## 读取经纬度

```{julia}
b = bbox(70, 15, 140, 55)
LON, LAT = bbox2dims(b; cellsize=0.1)
```
